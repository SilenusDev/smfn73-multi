<!DOCTYPE html>
<html lang="fr" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roadmap Multisite Symfony 7.3 - Architecture Compl√®te + Git Subtree</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .phase-card {
            border-left: 4px solid #0d6efd;
            margin-bottom: 2rem;
        }
        .step-item {
            border-left: 2px solid #6c757d;
            padding-left: 1rem;
            margin-bottom: 1rem;
        }
        .priority-critical { border-left-color: #dc3545; }
        .priority-high { border-left-color: #fd7e14; }
        .priority-medium { border-left-color: #ffc107; }
        .priority-low { border-left-color: #198754; }
        .git-highlight {
            background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);
            border-radius: 10px;
            padding: 20px;
            color: white;
        }
        .architecture-highlight {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border-radius: 10px;
            padding: 20px;
            color: white;
        }
    </style>
</head>
<body class="bg-dark text-light">
    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center mb-3">
                    <span class="badge bg-primary fs-2">üöÄ Roadmap Multisite Symfony 7.3</span>
                </h1>
                <p class="text-center text-muted mb-5">Architecture Compl√®te + Git Subtree + Mailer OAuth2 + D√©ploiement S√©lectif</p>
            </div>
        </div>

        <!-- Architecture & Git Strategy -->
        <div class="row mb-5">
            <div class="col-md-6">
                <div class="architecture-highlight">
                    <h3><i class="bi bi-diagram-3"></i> Architecture Multisite</h3>
                    <div class="mt-3">
                        <h5>‚úÖ Entit√©s Blog Communes :</h5>
                        <ul class="mb-3">
                            <li>User, BlogPost, Category, Comment</li>
                            <li><strong>MAIS donn√©es s√©par√©es par site</strong></li>
                            <li>4 bases MariaDB ind√©pendantes</li>
                        </ul>
                        
                        <h5>‚úÖ Sp√©cificit√©s par Site :</h5>
                        <ul class="mb-0">
                            <li>Entit√©s m√©tier sp√©cifiques</li>
                            <li>Controllers personnalis√©s</li>
                            <li>Templates et assets uniques</li>
                            <li>Configuration d√©di√©e</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="git-highlight">
                    <h3><i class="bi bi-git"></i> Strat√©gie Git Subtree</h3>
                    <div class="mt-3">
                        <h5>üîß D√©veloppement Local :</h5>
                        <ul class="mb-3">
                            <li>1 repo avec tout (common + 4 sites)</li>
                            <li>Push automatique vers 5 repos GitLab</li>
                            <li>Scripts d'automatisation</li>
                        </ul>
                        
                        <h5>üöÄ D√©ploiement Production :</h5>
                        <ul class="mb-0">
                            <li>Pull s√©lectif : common + site(s) choisi(s)</li>
                            <li>Serveurs multiples possibles</li>
                            <li>Versioning ind√©pendant par site</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Structure Finale -->
        <div class="row mb-5">
            <div class="col-12">
                <div class="card bg-info text-dark">
                    <div class="card-header">
                        <h3>üìÅ Structure Finale du Projet</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>D√©veloppement Local :</h5>
                                <div class="bg-dark text-light p-3 rounded">
                                    <code>
/symfony-multisite-dev/<br>
‚îú‚îÄ‚îÄ /common/<br>
‚îÇ   ‚îú‚îÄ‚îÄ /src/Entity/<br>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User.php<br>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BlogPost.php<br>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Category.php<br>
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Comment.php<br>
‚îÇ   ‚îú‚îÄ‚îÄ /src/Service/<br>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SiteResolver.php<br>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DatabaseManager.php<br>
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MailerManager.php<br>
‚îÇ   ‚îî‚îÄ‚îÄ /templates/common/<br>
‚îú‚îÄ‚îÄ /site1/<br>
‚îÇ   ‚îú‚îÄ‚îÄ /src/Entity/Site1/<br>
‚îÇ   ‚îú‚îÄ‚îÄ /src/Controller/Site1/<br>
‚îÇ   ‚îú‚îÄ‚îÄ /templates/site1/<br>
‚îÇ   ‚îî‚îÄ‚îÄ /assets/site1/<br>
‚îú‚îÄ‚îÄ /site2/ (m√™me structure)<br>
‚îú‚îÄ‚îÄ /site3/ (m√™me structure)<br>
‚îú‚îÄ‚îÄ /site4/ (m√™me structure)<br>
‚îî‚îÄ‚îÄ /scripts/<br>
    ‚îú‚îÄ‚îÄ git-push-all.sh<br>
    ‚îî‚îÄ‚îÄ git-pull-selective.sh
                                    </code>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>Production (Exemple) :</h5>
                                <div class="bg-dark text-light p-3 rounded mb-3">
                                    <code>
/production-server1/<br>
‚îú‚îÄ‚îÄ /common/<br>
‚îî‚îÄ‚îÄ /site1/<br><br>
/production-server2/<br>
‚îú‚îÄ‚îÄ /common/<br>
‚îú‚îÄ‚îÄ /site2/<br>
‚îî‚îÄ‚îÄ /site3/
                                    </code>
                                </div>
                                
                                <h5>Repos GitLab :</h5>
                                <ul>
                                    <li><code>multisite-common</code></li>
                                    <li><code>multisite-site1</code></li>
                                    <li><code>multisite-site2</code></li>
                                    <li><code>multisite-site3</code></li>
                                    <li><code>multisite-site4</code></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 1 - Git Subtree Setup -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-critical">
                    <div class="card-header bg-danger">
                        <h2>Phase 1 : Configuration Git Subtree</h2>
                        <small>Dur√©e estim√©e : 1 jour - PRIORIT√â ABSOLUE</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>1.1 - Cr√©ation des 5 repos GitLab</h5>
                            <ul>
                                <li>Cr√©er les repos : <code>multisite-common</code>, <code>multisite-site1</code>, <code>multisite-site2</code>, <code>multisite-site3</code>, <code>multisite-site4</code></li>
                                <li>Initialiser avec README.md</li>
                                <li>Configurer les droits d'acc√®s</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>1.2 - Setup Git Subtree local</h5>
                            <div class="bg-dark text-light p-2 rounded mb-3">
                                <code>
# Depuis le dossier principal<br>
git subtree add --prefix=common git@gitlab.com:yourproject/multisite-common.git main<br>
git subtree add --prefix=site1 git@gitlab.com:yourproject/multisite-site1.git main<br>
git subtree add --prefix=site2 git@gitlab.com:yourproject/multisite-site2.git main<br>
git subtree add --prefix=site3 git@gitlab.com:yourproject/multisite-site3.git main<br>
git subtree add --prefix=site4 git@gitlab.com:yourproject/multisite-site4.git main
                                </code>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>1.3 - Scripts d'automatisation</h5>
                            <p><strong>Cr√©er :</strong> <code>/scripts/git-push-all.sh</code></p>
                            <div class="bg-dark text-light p-2 rounded mb-2">
                                <code>
#!/bin/bash<br>
echo "üöÄ Push vers tous les repos..."<br>
git subtree push --prefix=common git@gitlab.com:yourproject/multisite-common.git main<br>
git subtree push --prefix=site1 git@gitlab.com:yourproject/multisite-site1.git main<br>
git subtree push --prefix=site2 git@gitlab.com:yourproject/multisite-site2.git main<br>
git subtree push --prefix=site3 git@gitlab.com:yourproject/multisite-site3.git main<br>
git subtree push --prefix=site4 git@gitlab.com:yourproject/multisite-site4.git main<br>
echo "‚úÖ Push termin√© !"
                                </code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 2 - Apache & Domaines -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-critical">
                    <div class="card-header bg-danger">
                        <h2>Phase 2 : Configuration Apache & Domaines</h2>
                        <small>Dur√©e estim√©e : 1 jour</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>2.1 - Configuration /etc/hosts</h5>
                            <div class="bg-dark text-light p-2 rounded mb-3">
                                <code>
# Ajout dans /etc/hosts<br>
127.0.0.1    site1.local<br>
127.0.0.1    site2.local<br>
127.0.0.1    site3.local<br>
127.0.0.1    site4.local
                                </code>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>2.2 - VirtualHosts Apache</h5>
                            <p><strong>4 VirtualHosts pointant vers le m√™me DocumentRoot</strong></p>
                            <div class="alert alert-info">
                                Tous pointent vers <code>/var/www/symfony-multisite-dev/public</code>
                            </div>
                            <ul>
                                <li>Cr√©er les fichiers .conf dans sites-available</li>
                                <li>Activer avec a2ensite</li>
                                <li>Red√©marrer Apache</li>
                                <li>Tester l'acc√®s aux 4 domaines</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>2.3 - Variables d'environnement</h5>
                            <div class="bg-dark text-light p-2 rounded">
                                <code>
# .env<br>
SITE1_DB_NAME=multisite_site1<br>
SITE2_DB_NAME=multisite_site2<br>
SITE3_DB_NAME=multisite_site3<br>
SITE4_DB_NAME=multisite_site4<br>
SITE1_MAILER_DSN=gmail+oauth2://...<br>
# etc.
                                </code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 3 - Architecture Multisite -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-critical">
                    <div class="card-header bg-danger">
                        <h2>Phase 3 : Services Multisite Fondamentaux</h2>
                        <small>Dur√©e estim√©e : 2 jours - C≈íUR DU SYST√àME</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>3.1 - Service SiteResolver</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Service/SiteResolver.php</code></p>
                            <p><strong>Symfony Features :</strong> <code>Service Container</code>, <code>RequestStack</code></p>
                            <ul>
                                <li>M√©thode <code>getCurrentSite()</code> bas√©e sur <code>$_SERVER['HTTP_HOST']</code></li>
                                <li>Retourne 'site1', 'site2', 'site3' ou 'site4'</li>
                                <li>Mapping domaine ‚Üí site dans config</li>
                                <li>Gestion erreur domaine inconnu</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>3.2 - EventSubscriber SiteInitializer</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/EventSubscriber/SiteInitializerSubscriber.php</code></p>
                            <p><strong>Symfony Features :</strong> <code>EventSubscriber</code>, <code>kernel.request</code></p>
                            <ul>
                                <li>√âcoute <code>kernel.request</code> tr√®s t√¥t</li>
                                <li>Injection du SiteResolver</li>
                                <li>D√©finit le contexte global site actuel</li>
                                <li>Accessible dans toute l'application</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>3.3 - Tests de d√©tection par site</h5>
                            <ul>
                                <li>Page debug : <code>/debug/site</code></li>
                                <li>Tester avec les 4 domaines locaux</li>
                                <li>V√©rifier d√©tection correcte</li>
                                <li>Tests unitaires SiteResolver</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 4 - Configuration Doctrine -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-critical">
                    <div class="card-header bg-danger">
                        <h2>Phase 4 : Configuration Doctrine Multi-Bases</h2>
                        <small>Dur√©e estim√©e : 2 jours - ISOLATION DONN√âES</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>4.1 - Cr√©ation des 4 bases MariaDB</h5>
                            <div class="bg-dark text-light p-2 rounded mb-3">
                                <code>
CREATE DATABASE multisite_site1;<br>
CREATE DATABASE multisite_site2;<br>
CREATE DATABASE multisite_site3;<br>
CREATE DATABASE multisite_site4;<br>
GRANT ALL ON multisite_site1.* TO 'your_user'@'localhost';<br>
GRANT ALL ON multisite_site2.* TO 'your_user'@'localhost';<br>
GRANT ALL ON multisite_site3.* TO 'your_user'@'localhost';<br>
GRANT ALL ON multisite_site4.* TO 'your_user'@'localhost';
                                </code>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>4.2 - Configuration Doctrine avec 4 Entity Managers</h5>
                            <p><strong>Fichier :</strong> <code>/common/config/packages/doctrine.yaml</code></p>
                            <p><strong>Symfony Features :</strong> <code>Doctrine Bundle</code>, <code>Multiple Connections</code></p>
                            <ul>
                                <li>4 connexions distinctes (site1, site2, site3, site4)</li>
                                <li>4 Entity Managers s√©par√©s</li>
                                <li>Mapping : entit√©s communes + sp√©cifiques par site</li>
                                <li>Variables d'environnement par base</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>4.3 - Service DatabaseManager</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Service/DatabaseManager.php</code></p>
                            <p><strong>Objectif :</strong> Obtenir automatiquement le bon Entity Manager</p>
                            <ul>
                                <li>Injection SiteResolver</li>
                                <li>M√©thode <code>getEntityManager()</code> contextuelle</li>
                                <li>M√©thode <code>getRepository($entity)</code> contextuelle</li>
                                <li>Gestion erreurs connexion</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 5 - Entit√©s Blog -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-high">
                    <div class="card-header bg-warning text-dark">
                        <h2>Phase 5 : Entit√©s Blog Communes</h2>
                        <small>Dur√©e estim√©e : 2 jours - STRUCTURE DONN√âES</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>5.1 - Entit√©s communes dans /common/</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Entity/</code></p>
                            <div class="row">
                                <div class="col-md-6">
                                    <strong>Entit√©s blog :</strong>
                                    <ul>
                                        <li><code>User.php</code> (avec UserInterface)</li>
                                        <li><code>BlogPost.php</code></li>
                                        <li><code>Category.php</code></li>
                                        <li><code>Comment.php</code></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <strong>Relations :</strong>
                                    <ul>
                                        <li>BlogPost ‚Üí Category (ManyToOne)</li>
                                        <li>BlogPost ‚Üí Comments (OneToMany)</li>
                                        <li>User ‚Üí BlogPosts (OneToMany)</li>
                                        <li>User ‚Üí Comments (OneToMany)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>5.2 - Entit√©s sp√©cifiques par site</h5>
                            <p><strong>Exemple :</strong> <code>/site1/src/Entity/Site1/Product.php</code></p>
                            <ul>
                                <li>Entit√©s m√©tier sp√©cifiques (Product, Service, Booking...)</li>
                                <li>Relations possibles avec entit√©s communes</li>
                                <li>Namespace diff√©rent par site</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>5.3 - Traits r√©utilisables</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Entity/Traits/</code></p>
                            <ul>
                                <li><code>TimestampableTrait</code> (created_at, updated_at)</li>
                                <li><code>SluggableTrait</code> (g√©n√©ration slug automatique)</li>
                                <li><code>PublishableTrait</code> (status, published_at)</li>
                                <li><code>SeoTrait</code> (meta_title, meta_description)</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>5.4 - Migrations pour les 4 bases</h5>
                            <p><strong>Symfony Features :</strong> <code>DoctrineMigrationsBundle</code></p>
                            <ul>
                                <li>G√©n√©rer migrations pour chaque Entity Manager</li>
                                <li>Script d'ex√©cution pour les 4 bases</li>
                                <li>Fixtures communes et sp√©cifiques</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 6 - Mailer OAuth2 -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-high">
                    <div class="card-header" style="background-color: #e83e8c; color: white;">
                        <h2>Phase 6 : Mailer OAuth2 par Site</h2>
                        <small>Dur√©e estim√©e : 2 jours - EMAIL CONTEXTUEL</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>6.1 - Configuration OAuth2 Gmail par site</h5>
                            <p><strong>Emplacement config :</strong> <code>/common/config/packages/mailer.yaml</code></p>
                            <p><strong>Bundle :</strong> <code>league/oauth2-google</code></p>
                            <div class="alert alert-success">
                                <strong>Strat√©gie :</strong> 4 comptes Gmail avec OAuth2 pour isolation compl√®te
                            </div>
                            <ul>
                                <li>Cr√©er 4 projets Google Cloud Console</li>
                                <li>4 sets de credentials OAuth2</li>
                                <li>Configuration dans variables d'environnement</li>
                                <li>Gestion refresh tokens par site</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>6.2 - Service MailerManager</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Service/MailerManager.php</code></p>
                            <p><strong>Objectif :</strong> Envoi automatique avec bon compte selon site</p>
                            <ul>
                                <li>Injection SiteResolver + Mailer</li>
                                <li>S√©lection automatique transport OAuth2</li>
                                <li>M√©thodes <code>sendEmail()</code> et <code>sendTemplatedEmail()</code></li>
                                <li>Gestion erreurs envoi par site</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>6.3 - Templates email avec fallback</h5>
                            <ul>
                                <li>Templates communs : <code>/common/templates/emails/</code></li>
                                <li>Templates sp√©cifiques : <code>/site1/templates/emails/</code></li>
                                <li>Syst√®me de fallback automatique</li>
                                <li>Variables contextuelles (exp√©diteur, signature)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 7 - Authentification -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-medium">
                    <div class="card-header" style="background-color: #6f42c1; color: white;">
                        <h2>Phase 7 : Authentification Contextuelle</h2>
                        <small>Dur√©e estim√©e : 2-3 jours - S√âCURIT√â</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>7.1 - UserProvider contextuel</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Security/SiteAwareUserProvider.php</code></p>
                            <p><strong>Symfony Features :</strong> <code>UserProviderInterface</code>, <code>Security Component</code></p>
                            <ul>
                                <li>Injection DatabaseManager</li>
                                <li>Recherche utilisateur dans la bonne base</li>
                                <li>Isolation compl√®te des comptes</li>
                                <li>Support refresh et load by identifier</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>7.2 - Configuration Security</h5>
                            <p><strong>Fichier :</strong> <code>/common/config/packages/security.yaml</code></p>
                            <div class="alert alert-info">
                                <strong>Strat√©gie :</strong> 1 firewall principal avec UserProvider contextuel
                            </div>
                            <ul>
                                <li>Firewall unique avec SiteAwareUserProvider</li>
                                <li>Routes login/logout communes</li>
                                <li>Sessions isol√©es par domaine</li>
                                <li>Gestion r√¥les par site</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>7.3 - Controllers authentification</h5>
                            <ul>
                                <li>LoginController commun</li>
                                <li>Templates login avec override par site</li>
                                <li>Redirections contextuelles</li>
                                <li>Tests connexion sur 4 sites</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 8 - Controllers et Templates -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-medium">
                    <div class="card-header" style="background-color: #20c997; color: white;">
                        <h2>Phase 8 : Controllers et Templates par Site</h2>
                        <small>Dur√©e estim√©e : 3-4 jours - FONCTIONNALIT√âS</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>8.1 - BaseController commun</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Controller/BaseController.php</code></p>
                            <ul>
                                <li>Injection : SiteResolver, DatabaseManager, MailerManager</li>
                                <li>M√©thodes utilitaires : <code>getCurrentSite()</code>, <code>getEM()</code>, <code>sendEmail()</code></li>
                                <li>Gestion centralis√©e des erreurs</li>
                                <li>Tous les controllers √©tendent BaseController</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>8.2 - Controllers sp√©cifiques par site</h5>
                            <p><strong>Exemple :</strong> <code>/site1/src/Controller/Site1/HomeController.php</code></p>
                            <ul>
                                <li>BlogController par site (avec sp√©cificit√©s)</li>
                                <li>Controllers m√©tier sp√©cifiques</li>
                                <li>Namespace et routing adapt√©s</li>
                                <li>Repositories contextuels automatiques</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>8.3 - Organisation templates hi√©rarchique</h5>
                            <div class="bg-dark text-light p-2 rounded mb-3">
                                <code>
/common/templates/<br>
‚îú‚îÄ‚îÄ base.html.twig<br>
‚îú‚îÄ‚îÄ /blog/ (templates base)<br>
‚îî‚îÄ‚îÄ /emails/<br><br>
/site1/templates/<br>
‚îú‚îÄ‚îÄ base.html.twig (extends common)<br>
‚îú‚îÄ‚îÄ /blog/ (overrides)<br>
‚îî‚îÄ‚îÄ /pages/
                                </code>
                            </div>
                            <ul>
                                <li>H√©ritage avec fallback automatique</li>
                                <li>Variables Twig globales contextuelles</li>
                                <li>Service TemplateResolver</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 9 - Assets et Webpack -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-medium">
                    <div class="card-header bg-secondary">
                        <h2>Phase 9 : Assets et Webpack Encore</h2>
                        <small>Dur√©e estim√©e : 2-3 jours - FRONT-END</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>9.1 - Configuration Webpack multisite</h5>
                            <p><strong>Fichier :</strong> <code>webpack.config.js</code></p>
                            <p><strong>Tools :</strong> <code>Symfony Webpack Encore</code>, <code>SCSS</code></p>
                            <div class="alert alert-info">
                                <strong>Strat√©gie :</strong> Entry points communs + sp√©cifiques par site
                            </div>
                            <ul>
                                <li>Entry <code>common</code> : SCSS/JS partag√©s</li>
                                <li>Entry <code>site1</code>, <code>site2</code>, etc. : Assets sp√©cifiques</li>
                                <li>Variables SCSS communes import√©es</li>
                                <li>Build optimis√© avec code splitting</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>9.2 - SCSS modulaire</h5>
                            <div class="bg-dark text-light p-2 rounded mb-3">
                                <code>
/common/assets/<br>
‚îú‚îÄ‚îÄ /styles/<br>
‚îÇ   ‚îú‚îÄ‚îÄ _variables.scss<br>
‚îÇ   ‚îú‚îÄ‚îÄ _mixins.scss<br>
‚îÇ   ‚îî‚îÄ‚îÄ common.scss<br>
‚îî‚îÄ‚îÄ /js/<br><br>
/site1/assets/<br>
‚îú‚îÄ‚îÄ /styles/<br>
‚îÇ   ‚îú‚îÄ‚îÄ _site1-variables.scss<br>
‚îÇ   ‚îî‚îÄ‚îÄ site1.scss<br>
‚îî‚îÄ‚îÄ /js/
                                </code>
                            </div>
                            <ul>
                                <li>Variables communes + override par site</li>
                                <li>Compilation s√©par√©e par site</li>
                                <li>Optimisation et minification</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>9.3 - AssetManager contextuel</h5>
                            <p><strong>Objectif :</strong> Charger automatiquement les bons assets</p>
                            <ul>
                                <li>Service pour r√©solution assets par site</li>
                                <li>Helper Twig pour inclusion contextuelle</li>
                                <li>Cache et versioning assets</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 10 - Admin Interface -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-low">
                    <div class="card-header bg-dark">
                        <h2>Phase 10 : Interface d'Administration</h2>
                        <small>Dur√©e estim√©e : 2-3 jours - GESTION</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>10.1 - AdminController contextuel</h5>
                            <p><strong>Emplacement :</strong> <code>/common/src/Controller/Admin/AdminController.php</code></p>
                            <ul>
                                <li>Dashboard avec stats du site actuel</li>
                                <li>CRUD contextuels (posts, users, comments)</li>
                                <li>Gestion des utilisateurs du site</li>
                                <li>Interface avec EasyAdmin</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>10.2 - Permissions et s√©curit√© admin</h5>
                            <ul>
                                <li>R√¥les admin par site</li>
                                <li>Voter pour l'acc√®s aux donn√©es</li>
                                <li>Audit trail des modifications</li>
                                <li>Interface de switching entre sites</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>10.3 - Outils de gestion multisite</h5>
                            <ul>
                                <li>Vue globale des 4 sites</li>
                                <li>Statistiques comparatives</li>
                                <li>Import/Export de donn√©es</li>
                                <li>Outils de maintenance</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 11 - Scripts D√©ploiement -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-low">
                    <div class="card-header" style="background-color: #fd7e14; color: white;">
                        <h2>Phase 11 : Scripts de D√©ploiement Avanc√©s</h2>
                        <small>Dur√©e estim√©e : 2 jours - AUTOMATISATION</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>11.1 - Script de d√©ploiement production</h5>
                            <p><strong>Fichier :</strong> <code>/scripts/deploy-production.sh</code></p>
                            <div class="bg-dark text-light p-2 rounded mb-3">
                                <code>
#!/bin/bash<br>
# Usage: ./deploy-production.sh server1 site1,site3<br>
SERVER=$1<br>
SITES=$2<br><br>
echo "üöÄ D√©ploiement vers $SERVER avec sites: $SITES"<br>
ssh $SERVER "cd /var/www && git subtree pull common main"<br>
for site in $(echo $SITES | tr "," "\n"); do<br>
&nbsp;&nbsp;ssh $SERVER "cd /var/www && git subtree pull $site main"<br>
done<br>
echo "‚úÖ D√©ploiement termin√© !"
                                </code>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>11.2 - Scripts de maintenance</h5>
                            <ul>
                                <li><code>migrate-all.sh</code> : Migrations sur toutes les bases</li>
                                <li><code>cache-clear-all.sh</code> : Clear cache tous sites</li>
                                <li><code>assets-build.sh</code> : Build assets pour d√©ploiement</li>
                                <li><code>backup-sites.sh</code> : Sauvegarde s√©lective</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>11.3 - Configuration CI/CD</h5>
                            <p><strong>GitLab CI :</strong> Pipeline par repo</p>
                            <ul>
                                <li>Tests automatis√©s par site</li>
                                <li>Build et d√©ploiement automatique</li>
                                <li>Rollback automatique en cas d'erreur</li>
                                <li>Notifications d√©ploiement</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 12 - Tests -->
        <div class="row">
            <div class="col-12">
                <div class="card phase-card priority-low">
                    <div class="card-header bg-success">
                        <h2>Phase 12 : Tests et Validation</h2>
                        <small>Dur√©e estim√©e : 2-3 jours - QUALIT√â</small>
                    </div>
                    <div class="card-body">
                        <div class="step-item">
                            <h5>12.1 - Tests unitaires services</h5>
                            <p><strong>Symfony Features :</strong> <code>PHPUnit Bridge</code></p>
                            <ul>
                                <li>Tests SiteResolver (d√©tection par domaine)</li>
                                <li>Tests DatabaseManager (bonne base par site)</li>
                                <li>Tests MailerManager (bon exp√©diteur par site)</li>
                                <li>Tests UserProvider contextuel</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>12.2 - Tests fonctionnels par site</h5>
                            <p><strong>Symfony Features :</strong> <code>WebTestCase</code></p>
                            <ul>
                                <li>Tests navigation blog par site</li>
                                <li>Tests authentification isol√©e</li>
                                <li>Tests envoi emails contextuels</li>
                                <li>Tests admin par site</li>
                            </ul>
                        </div>

                        <div class="step-item">
                            <h5>12.3 - Tests d'int√©gration multisite</h5>
                            <ul>
                                <li>Tests isolation des donn√©es</li>
                                <li>Tests performance avec 4 bases</li>
                                <li>Tests d√©ploiement Git Subtree</li>
                                <li>Tests de charge par site</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Workflow Git Subtree -->
        <div class="row">
            <div class="col-12">
                <div class="card bg-purple text-white" style="background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);">
                    <div class="card-header">
                        <h3>üîÑ Workflow Git Subtree - Usage Quotidien</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>üíª D√©veloppement Local :</h5>
                                <div class="bg-dark text-light p-2 rounded mb-3">
                                    <code>
# D√©veloppement normal<br>
git add .<br>
git commit -m "Feature: nouvelle fonctionnalit√©"<br><br>
# Push vers tous les repos<br>
./scripts/git-push-all.sh<br><br>
# Ou push s√©lectif<br>
git subtree push --prefix=common origin main<br>
git subtree push --prefix=site1 origin main
                                    </code>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>üöÄ D√©ploiement Production :</h5>
                                <div class="bg-dark text-light p-2 rounded mb-3">
                                    <code>
# Serveur 1 : common + site1<br>
ssh server1<br>
git subtree pull common main<br>
git subtree pull site1 main<br><br>
# Serveur 2 : common + site2 + site3<br>
ssh server2<br>
git subtree pull common main<br>
git subtree pull site2 main<br>
git subtree pull site3 main<br><br>
# Ou avec script<br>
./deploy-production.sh server1 site1<br>
./deploy-production.sh server2 site2,site3
                                    </code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommandations -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="card bg-success text-white">
                    <div class="card-header">
                        <h3>‚úÖ Recommandations d'Expert</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <h5>üéØ Priorit√©s :</h5>
                                <ul>
                                    <li>Phases 1-4 : Fondamentaux absolus</li>
                                    <li>Phases 5-7 : C≈ìur fonctionnel</li>
                                    <li>Phases 8-12 : Optimisations</li>
                                    <li>Tester avec 2 sites d'abord</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <h5>üîê S√©curit√© :</h5>
                                <ul>
                                    <li>Isolation compl√®te des donn√©es</li>
                                    <li>Sessions s√©par√©es par domaine</li>
                                    <li>Credentials OAuth2 distincts</li>
                                    <li>Tests de s√©curit√© r√©guliers</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <h5>‚ö° Performance :</h5>
                                <ul>
                                    <li>Cache par Entity Manager</li>
                                    <li>Assets optimis√©s par site</li>
                                    <li>Monitoring per-site</li>
                                    <li>Scaling horizontal facile</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <h5>üéâ Avantages de cette Architecture :</h5>
                                <div class="row">
                                    <div class="col-md-6">
                                        <ul>
                                            <li>‚úÖ D√©veloppement unifi√© local</li>
                                            <li>‚úÖ D√©ploiement s√©lectif flexible</li>
                                            <li>‚úÖ Isolation maximale des sites</li>
                                            <li>‚úÖ Code r√©utilisable (blog commun)</li>
                                            <li>‚úÖ Mailer OAuth2 par site</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <ul>
                                            <li>‚úÖ Versioning ind√©pendant par site</li>
                                            <li>‚úÖ Scaling par site possible</li>
                                            <li>‚úÖ Maintenance simplifi√©e</li>
                                            <li>‚úÖ S√©curit√© renforc√©e</li>
                                            <li>‚úÖ Evolution progressive</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="card bg-info text-dark">
                    <div class="card-header">
                        <h3>üìÖ Timeline Recommand√©e</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <h5>Semaine 1 :</h5>
                                <ul>
                                    <li>Phase 1-2 : Git + Apache</li>
                                    <li>Phase 3-4 : Services + DB</li>
                                    <li>Tests fondamentaux</li>
                                </ul>
                            </div>
                            <div class="col-md-3">
                                <h5>Semaine 2 :</h5>
                                <ul>
                                    <li>Phase 5-6 : Entit√©s + Mailer</li>
                                    <li>Phase 7 : Authentification</li>
                                    <li>Tests avec 2 sites</li>
                                </ul>
                            </div>
                            <div class="col-md-3">
                                <h5>Semaine 3 :</h5>
                                <ul>
                                    <li>Phase 8-9 : Controllers + Assets</li>
                                    <li>Phase 10 : Admin</li>
                                    <li>Extension aux 4 sites</li>
                                </ul>
                            </div>
                            <div class="col-md-3">
                                <h5>Semaine 4 :</h5>
                                <ul>
                                    <li>Phase 11-12 : Deploy + Tests</li>
                                    <li>Optimisations finales</li>
                                    <li>Documentation compl√®te</li>
                                </ul>
                            </div>
                        </div>
                        <div class="alert alert-warning mt-3">
                            <strong>Dur√©e totale estim√©e :</strong> 3-4 semaines pour un d√©veloppeur junior avec cette roadmap d√©taill√©e
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>
</html>