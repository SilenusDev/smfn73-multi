# pods/apache/config/symfony.conf
# Configuration Apache multi-sites pour Symfony avec PHP-FPM

# VirtualHost pour Silenus
<VirtualHost *:80>
    ServerName silenus.local
    ServerAlias www.silenus.local
    DocumentRoot /usr/local/apache2/htdocs/public

    <Directory /usr/local/apache2/htdocs/public>
        AllowOverride All
        Require all granted
        FallbackResource /index.php
        
        # Activer les index
        DirectoryIndex index.php
        Options -Indexes +FollowSymLinks
    </Directory>

    # Configuration PHP-FPM
    <FilesMatch \.php$>
        SetHandler "proxy:fcgi://127.0.0.1:9000"
    </FilesMatch>

    # Logs spécifiques Silenus
    ErrorLog /usr/local/apache2/logs/silenus_error.log
    CustomLog /usr/local/apache2/logs/silenus_access.log combined
</VirtualHost>

# VirtualHost pour Insidiome (NSDM)
<VirtualHost *:80>
    ServerName insidiome.local
    ServerAlias www.insidiome.local
    DocumentRoot /usr/local/apache2/htdocs/public

    <Directory /usr/local/apache2/htdocs/public>
        AllowOverride All
        Require all granted
        FallbackResource /index.php
        
        # Activer les index
        DirectoryIndex index.php
        Options -Indexes +FollowSymLinks
    </Directory>

    # Configuration PHP-FPM
    <FilesMatch \.php$>
        SetHandler "proxy:fcgi://127.0.0.1:9000"
    </FilesMatch>

    # Logs spécifiques Insidiome
    ErrorLog /usr/local/apache2/logs/insidiome_error.log
    CustomLog /usr/local/apache2/logs/insidiome_access.log combined
</VirtualHost>

# VirtualHost par défaut (localhost) - redirige vers Silenus
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /usr/local/apache2/htdocs/public

    <Directory /usr/local/apache2/htdocs/public>
        AllowOverride All
        Require all granted
        FallbackResource /index.php
        
        # Activer les index
        DirectoryIndex index.php
        Options -Indexes +FollowSymLinks
    </Directory>

    # Configuration PHP-FPM
    <FilesMatch \.php$>
        SetHandler "proxy:fcgi://127.0.0.1:9000"
    </FilesMatch>

    # Logs
    ErrorLog /usr/local/apache2/logs/error.log
    CustomLog /usr/local/apache2/logs/access.log combined
</VirtualHost>
