# pods/node/pod.yml.template
# Configuration du pod Node.js 20 (build assets)
# Ce fichier est un TEMPLATE - il sera généré automatiquement par generate-pod-configs.sh

apiVersion: v1
kind: Pod
metadata:
  name: ${PROJECT_NAME}-node-pod
  labels:
    app: ${PROJECT_NAME}
    service: node
    category: build
spec:
  containers:
  - name: ${PROJECT_NAME}-node
    image: ${IMAGE_NODE}
    ports:
    - containerPort: 5173
      hostPort: ${NODE_PORT}
    workingDir: /app
    command: ["sh", "-c", "npm install && npm run watch"]
    env:
    - name: NODE_ENV
      value: "development"
    volumeMounts:
    - name: symfony-code
      mountPath: /app
    - name: node-modules
      mountPath: /app/node_modules
  volumes:
  - name: symfony-code
    hostPath:
      path: ${PROJECT_ROOT}
      type: Directory
  - name: node-modules
    hostPath:
      path: ${PROJECT_ROOT}/pods/node/data/node_modules
      type: DirectoryOrCreate
  restartPolicy: Always
